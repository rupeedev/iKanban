import { jsx as _jsx } from "react/jsx-runtime";
import { ariaDescribedByIds, enumOptionsIndexForValue, enumOptionsValueForIndex, } from '@rjsf/utils';
import { FancyMultiSelect } from '../components/ui/fancy-multi-select.js';
import { FancySelect } from '../components/ui/fancy-select.js';
import { cn } from '../lib/utils.js';
/** The `SelectWidget` is a widget for rendering dropdowns.
 *  It is typically used with string properties constrained with enum options.
 *
 * @param props - The `WidgetProps` for this component
 */
export default function SelectWidget({ id, options, required, disabled, readonly, value, multiple, autofocus, onChange, onBlur, onFocus, defaultValue, placeholder, rawErrors = [], className, }) {
    const { enumOptions, enumDisabled, emptyValue: optEmptyValue } = options;
    const _onFancyFocus = () => {
        onFocus(id, enumOptionsValueForIndex(value, enumOptions, optEmptyValue));
    };
    const _onFancyBlur = () => {
        onBlur(id, enumOptionsValueForIndex(value, enumOptions, optEmptyValue));
    };
    const items = enumOptions === null || enumOptions === void 0 ? void 0 : enumOptions.map(({ value, label }, index) => ({
        value: multiple ? value : index.toString(),
        label: label,
        index,
        disabled: Array.isArray(enumDisabled) && enumDisabled.includes(value),
    }));
    const cnClassName = cn({ 'border-destructive': rawErrors.length > 0 }, className);
    return (_jsx("div", { className: 'p-0.5', children: !multiple ? (_jsx(FancySelect, { items: items, selected: enumOptionsIndexForValue(value !== null && value !== void 0 ? value : defaultValue, enumOptions, false), onValueChange: (selectedValue) => {
                onChange(enumOptionsValueForIndex(selectedValue, enumOptions, optEmptyValue));
            }, autoFocus: autofocus, disabled: disabled || readonly, required: required, placeholder: placeholder, className: cnClassName, onFocus: _onFancyFocus, onBlur: _onFancyBlur, ariaDescribedby: ariaDescribedByIds(id) })) : (_jsx(FancyMultiSelect, { id: id, autoFocus: autofocus, disabled: disabled || readonly, multiple: true, className: cnClassName, items: items, selected: value, onValueChange: (values) => {
                onChange(enumOptionsValueForIndex(values, enumOptions, optEmptyValue));
            }, onFocus: _onFancyFocus, onBlur: _onFancyBlur })) }));
}
//# sourceMappingURL=SelectWidget.js.map