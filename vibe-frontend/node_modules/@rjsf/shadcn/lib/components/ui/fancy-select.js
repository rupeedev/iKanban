'use client';
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { Check, ChevronDown } from 'lucide-react';
import { useEffect, useRef, useState } from 'react';
import { cn } from '../../lib/utils.js';
import { Command, CommandGroup, CommandItem, CommandList } from './command.js';
/**
 * A fancy select component that provides a styled dropdown with search functionality
 * @param props - The component props
 * @returns A React component that renders a searchable select dropdown
 */
export function FancySelect({ items, selected, onValueChange, autoFocus = false, disabled = false, required = false, placeholder = 'Select...', ariaDescribedby, ariaPlaceholder, onFocus, onBlur, className, }) {
    const [open, setOpen] = useState(false);
    const selectedItem = items === null || items === void 0 ? void 0 : items.find((item) => item.value === selected);
    const selectedRef = useRef(null);
    const containerRef = useRef(null);
    useEffect(() => {
        if (open && selectedRef.current) {
            requestAnimationFrame(() => {
                var _a;
                (_a = selectedRef.current) === null || _a === void 0 ? void 0 : _a.scrollIntoView({ block: 'nearest' });
            });
        }
    }, [open]);
    const handleBlur = (e) => {
        if (containerRef.current && !containerRef.current.contains(e.relatedTarget)) {
            setOpen(false);
        }
        onBlur === null || onBlur === void 0 ? void 0 : onBlur(e);
    };
    return (_jsxs(Command, { ref: containerRef, className: cn('overflow-visible bg-transparent', className), autoFocus: autoFocus, "aria-disabled": disabled, onBlur: handleBlur, onFocus: onFocus, "aria-describedby": ariaDescribedby, "aria-placeholder": ariaPlaceholder, children: [_jsxs("div", { onClick: () => !disabled && setOpen(!open), className: cn('flex h-9 w-full items-center justify-between gap-2 whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50', !selectedItem && required && 'border-red-500', disabled && 'opacity-50 cursor-not-allowed', className), children: [_jsx("span", { className: cn('flex-1 line-clamp-1', !selectedItem && 'text-muted-foreground'), children: (selectedItem === null || selectedItem === void 0 ? void 0 : selectedItem.label) || placeholder }), _jsx(ChevronDown, { className: 'h-4 w-4 opacity-50' })] }), _jsx("div", { className: 'relative', children: open && items && items.length > 0 ? (_jsx("div", { style: { top: '0.5rem' }, className: 'absolute w-full z-10 rounded-md border bg-popover text-popover-foreground shadow-md outline-none', children: _jsx(CommandGroup, { className: 'h-full overflow-auto', children: _jsx(CommandList, { children: items.map((item) => (_jsxs(CommandItem, { ref: item.value === selected ? selectedRef : undefined, onMouseDown: (e) => {
                                    e.preventDefault();
                                    e.stopPropagation();
                                }, onSelect: () => {
                                    if (!item.disabled) {
                                        onValueChange === null || onValueChange === void 0 ? void 0 : onValueChange(item.value);
                                        setOpen(false);
                                    }
                                }, className: cn('cursor-pointer relative flex items-center justify-between rounded-sm py-1.5 gap-2 rtl:flex-row-reverse', item.value === selected && 'font-semibold', item.disabled && 'opacity-50 cursor-not-allowed'), children: [_jsx("span", { children: item.label }), _jsx("span", { className: 'flex h-3.5 w-3.5 items-center justify-center', children: item.value === selected && _jsx(Check, { className: 'h-4 w-4' }) })] }, item.value))) }) }) })) : null })] }));
}
//# sourceMappingURL=fancy-select.js.map